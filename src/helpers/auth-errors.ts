import type { authClient } from '@/lib/auth-client'

type AuthErrorCode = keyof typeof authClient.$ERROR_CODES

const AUTH_ERRORS_FR = {
  USER_NOT_FOUND: 'Utilisateur introuvable',
  FAILED_TO_CREATE_USER: 'Impossible de créer le compte',
  FAILED_TO_CREATE_SESSION: 'Impossible de créer la session',
  FAILED_TO_UPDATE_USER: 'Impossible de mettre à jour le compte',
  FAILED_TO_GET_SESSION: 'Impossible de récupérer la session',
  INVALID_PASSWORD: 'Le mot de passe est incorrect',
  INVALID_EMAIL: 'Email invalide',
  INVALID_EMAIL_OR_PASSWORD: 'Email ou mot de passe invalide',
  SOCIAL_ACCOUNT_ALREADY_LINKED: 'Ce compte social est déjà lié',
  PROVIDER_NOT_FOUND: 'Fournisseur introuvable',
  INVALID_TOKEN: 'Lien expiré ou invalide',
  ID_TOKEN_NOT_SUPPORTED: 'Token non supporté',
  FAILED_TO_GET_USER_INFO: 'Impossible de récupérer les informations',
  USER_EMAIL_NOT_FOUND: 'Email introuvable',
  EMAIL_NOT_VERIFIED: 'Veuillez vérifier votre email avant de vous connecter',
  PASSWORD_TOO_SHORT: 'Mot de passe trop court (8 caractères minimum)',
  PASSWORD_TOO_LONG: 'Mot de passe trop long',
  USER_ALREADY_EXISTS: 'Cette adresse email est déjà utilisée',
  USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL:
    'Cette adresse email est déjà utilisée',
  EMAIL_CAN_NOT_BE_UPDATED: "L'email ne peut pas être modifié",
  CREDENTIAL_ACCOUNT_NOT_FOUND: 'Compte introuvable',
  SESSION_EXPIRED: 'Session expirée, veuillez vous reconnecter',
  FAILED_TO_UNLINK_LAST_ACCOUNT: 'Impossible de dissocier votre dernier compte',
  ACCOUNT_NOT_FOUND: 'Compte introuvable',
  USER_ALREADY_HAS_PASSWORD: 'Vous avez déjà un mot de passe',
  CROSS_SITE_NAVIGATION_LOGIN_BLOCKED:
    'Connexion bloquée pour raison de sécurité',
  VERIFICATION_EMAIL_NOT_ENABLED: "La vérification d'email n'est pas activée",
  EMAIL_ALREADY_VERIFIED: 'Email déjà vérifié',
  EMAIL_MISMATCH: "L'email ne correspond pas",
  SESSION_NOT_FRESH: 'Session expirée, veuillez vous reconnecter',
  LINKED_ACCOUNT_ALREADY_EXISTS: 'Ce compte est déjà lié',
  INVALID_ORIGIN: 'Origine invalide',
  INVALID_CALLBACK_URL: 'URL de retour invalide',
  INVALID_REDIRECT_URL: 'URL de redirection invalide',
  INVALID_ERROR_CALLBACK_URL: "URL de retour d'erreur invalide",
  INVALID_NEW_USER_CALLBACK_URL: 'URL de retour nouvel utilisateur invalide',
  MISSING_OR_NULL_ORIGIN: 'Origine manquante',
  CALLBACK_URL_REQUIRED: 'URL de retour requise',
  FAILED_TO_CREATE_VERIFICATION: 'Impossible de créer la vérification',
  FIELD_NOT_ALLOWED: 'Ce champ ne peut pas être modifié',
  ASYNC_VALIDATION_NOT_SUPPORTED: 'Validation asynchrone non supportée',
  VALIDATION_ERROR: 'Erreur de validation',
  MISSING_FIELD: 'Champ requis manquant'
} as const satisfies Record<AuthErrorCode, string>

export function getAuthErrorMessage(code: string) {
  const message = AUTH_ERRORS_FR[code as keyof typeof AUTH_ERRORS_FR]

  if (message) {
    return message
  }

  if (import.meta.env.DEV) {
    // eslint-disable-next-line no-console
    console.warn(`[auth-errors] Code non traduit: ${code}`)
  }

  return 'Une erreur est survenue'
}

const CHANGE_PASSWORD_ERRORS_FR = {
  PASSWORD_TOO_SHORT:
    'Le nouveau mot de passe est trop court (8 caractères minimum)',
  PASSWORD_TOO_LONG: 'Le nouveau mot de passe est trop long'
} as const satisfies Partial<Record<AuthErrorCode, string>>

export function getChangePasswordErrorMessage(code: string) {
  const contextMessage =
    CHANGE_PASSWORD_ERRORS_FR[code as keyof typeof CHANGE_PASSWORD_ERRORS_FR]

  if (contextMessage) {
    return contextMessage
  }

  return getAuthErrorMessage(code)
}
